# WebRTC è¿œç¨‹æ§åˆ¶ç³»ç»Ÿ

## ğŸ“± é¡¹ç›®ç®€ä»‹

è¿™æ˜¯ä¸€ä¸ªåŸºäº WebRTC æŠ€æœ¯çš„ Android è®¾å¤‡è¿œç¨‹æ§åˆ¶ç³»ç»Ÿï¼Œèƒ½å¤Ÿå®ç°å®æ—¶å±å¹•å…±äº«å’Œè¿œç¨‹è§¦æ‘¸æ§åˆ¶ã€‚ç³»ç»ŸåŒ…å«ä¸¤ä¸ªæ ¸å¿ƒç»„ä»¶ï¼š

- **ğŸ¯ Device App (Android)**ï¼šè¢«æ§åˆ¶çš„ Android è®¾å¤‡ç«¯ï¼Œè´Ÿè´£å±å¹•å…±äº«å’Œæ¥æ”¶æ§åˆ¶æŒ‡ä»¤
- **ğŸ“± Control App (Flutter)**ï¼šæ§åˆ¶ç«¯åº”ç”¨ï¼Œå¯åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šè¿è¡Œï¼Œç”¨äºè¿œç¨‹æ“ä½œ Android è®¾å¤‡

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

### ğŸ–¥ï¸ å®æ—¶å±å¹•å…±äº«
- ğŸ“º é«˜æ¸…å±å¹•å®æ—¶ä¼ è¾“ï¼ˆæœ€é«˜æ”¯æŒ 1824x1080 åˆ†è¾¨ç‡ï¼‰
- âš¡ ä½å»¶è¿Ÿæ˜¾ç¤ºï¼ˆç»è¿‡ä¼˜åŒ–çš„ WebRTC é…ç½®ï¼‰
- ğŸ¨ ç¡¬ä»¶ç¼–è§£ç åŠ é€Ÿ
- ğŸ“Š è‡ªé€‚åº”ç ç‡è°ƒæ•´ï¼ˆé»˜è®¤ 500kbpsï¼‰

### ğŸ® è¿œç¨‹è§¦æ‘¸æ§åˆ¶
- ğŸ‘† ç²¾ç¡®è§¦æ‘¸å®šä½å’Œåæ ‡æ˜ å°„
- ğŸ–±ï¸ å¤šç§æ‰‹åŠ¿æ”¯æŒï¼šç‚¹å‡»ã€é•¿æŒ‰ã€æ»‘åŠ¨
- âŒ¨ï¸ ç³»ç»ŸæŒ‰é”®æ§åˆ¶ï¼šè¿”å›é”®ã€ä¸»é¡µé”®ã€èœå•é”®
- ğŸ¯ å®æ—¶è§¦æ‘¸åé¦ˆ

### ğŸ”„ æ™ºèƒ½è¿æ¥ç®¡ç†
- ğŸŒ å±€åŸŸç½‘è®¾å¤‡è‡ªåŠ¨å‘ç°
- ğŸ”— WebSocket ä¿¡ä»¤äº¤æ¢
- ğŸ”„ è‡ªåŠ¨é‡è¿æœºåˆ¶
- ğŸ“± åº”ç”¨ç”Ÿå‘½å‘¨æœŸç®¡ç†

### ğŸ›¡ï¸ ç¨³å®šæ€§ä¿éšœ
- ğŸƒ å‰å°æœåŠ¡é˜²æ­¢æ„å¤–ç»ˆæ­¢
- ğŸ”§ å¼‚å¸¸å¤„ç†å’Œèµ„æºæ¸…ç†
- ğŸ“Š è¿æ¥çŠ¶æ€å®æ—¶ç›‘æ§
- ğŸ”’ æƒé™ç®¡ç†å’Œå®‰å…¨æ§åˆ¶

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    WebSocket     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Control App       â”‚â—„â”€â”€â”€â”€ ä¿¡ä»¤äº¤æ¢ â”€â”€â”€â”€â–ºâ”‚   Device App        â”‚
â”‚   (Flutter)         â”‚                  â”‚   (Android)         â”‚
â”‚                     â”‚    WebRTC        â”‚                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â—„â”€â”€â”€â”€ éŸ³è§†é¢‘æµ â”€â”€â”€â”€â–ºâ”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚   æ§åˆ¶ç•Œé¢      â”‚ â”‚                  â”‚ â”‚   å±å¹•æ•è·      â”‚ â”‚
â”‚ â”‚ - è§†é¢‘æ˜¾ç¤º      â”‚ â”‚   DataChannel    â”‚ â”‚ - MediaProjectionâ”‚ â”‚
â”‚ â”‚ - æ‰‹åŠ¿è¯†åˆ«      â”‚ â”‚â—„â”€â”€â”€â”€ æ§åˆ¶äº‹ä»¶ â”€â”€â”€â”€â–ºâ”‚ â”‚ - ScreenCapturer â”‚ â”‚
â”‚ â”‚ - åæ ‡æ˜ å°„      â”‚ â”‚                  â”‚ â”‚ - VideoSource   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                     â”‚                  â”‚                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ WebRTC Service  â”‚ â”‚                  â”‚ â”‚ WebRTC Manager  â”‚ â”‚
â”‚ â”‚ - Peerè¿æ¥      â”‚ â”‚                  â”‚ â”‚ - Peerè¿æ¥      â”‚ â”‚
â”‚ â”‚ - æµæ¥æ”¶        â”‚ â”‚                  â”‚ â”‚ - è§†é¢‘å‘é€      â”‚ â”‚
â”‚ â”‚ - äº‹ä»¶å‘é€      â”‚ â”‚                  â”‚ â”‚ - äº‹ä»¶æ¥æ”¶      â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                     â”‚                  â”‚                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ WebSocketå®¢æˆ·ç«¯ â”‚ â”‚                  â”‚ â”‚ WebSocketæœåŠ¡å™¨ â”‚ â”‚
â”‚ â”‚ - è®¾å¤‡å‘ç°      â”‚ â”‚                  â”‚ â”‚ - å®¢æˆ·ç«¯ç®¡ç†    â”‚ â”‚
â”‚ â”‚ - ä¿¡ä»¤å¤„ç†      â”‚ â”‚                  â”‚ â”‚ - æ¶ˆæ¯è·¯ç”±      â”‚ â”‚
â”‚ â”‚ - è‡ªåŠ¨é‡è¿      â”‚ â”‚                  â”‚ â”‚ - è¿æ¥ç›‘æ§      â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚                     â”‚
                                         â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                                         â”‚ â”‚ Touch Control   â”‚ â”‚
                                         â”‚ â”‚ - äº‹ä»¶è§£æ      â”‚ â”‚
                                         â”‚ â”‚ - Shellå‘½ä»¤     â”‚ â”‚
                                         â”‚ â”‚ - è§¦æ‘¸æ¨¡æ‹Ÿ      â”‚ â”‚
                                         â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”§ æŠ€æœ¯æ ˆ

### Device App (Android)
- **ğŸ“± å¹³å°**ï¼šAndroid 5.0+ (API Level 21+)
- **ğŸ”— WebRTC**ï¼šGoogle WebRTC åŸç”Ÿåº“
- **ğŸŒ ç½‘ç»œé€šä¿¡**ï¼šJava-WebSocket
- **ğŸ“¹ å±å¹•æ•è·**ï¼šMediaProjection API + ScreenCapturerAndroid
- **ğŸ¯ è§¦æ‘¸æ§åˆ¶**ï¼šAndroid Shell Inputå‘½ä»¤
- **ğŸ—‚ï¸ æ•°æ®åºåˆ—åŒ–**ï¼šGson

### Control App (Flutter)
- **ğŸ“± å¹³å°**ï¼šFlutter 3.0+ï¼Œæ”¯æŒ Android/iOS
- **ğŸ”— WebRTC**ï¼šflutter_webrtc æ’ä»¶
- **ğŸŒ ç½‘ç»œé€šä¿¡**ï¼šweb_socket_channel
- **ğŸ¨ UIæ¡†æ¶**ï¼šMaterial Design
- **ğŸ—‚ï¸ æ•°æ®åºåˆ—åŒ–**ï¼šjson_annotation

### æ ¸å¿ƒæŠ€æœ¯
- **ğŸ“¡ éŸ³è§†é¢‘ä¼ è¾“**ï¼šWebRTC P2Pè¿æ¥
- **ğŸ”„ ä¿¡ä»¤äº¤æ¢**ï¼šWebSocket
- **ğŸ¥ è§†é¢‘ç¼–ç **ï¼šVP8/VP9 ç¡¬ä»¶ç¼–ç 
- **ğŸ¯ åæ ‡æ˜ å°„**ï¼šå®æ—¶åæ ‡è½¬æ¢ç®—æ³•
- **ğŸ”— è¿æ¥ç®¡ç†**ï¼šICEåè®® + STUN/TURN

## ğŸ“¦ å®‰è£…é…ç½®

### ç¯å¢ƒè¦æ±‚

#### Device App ç¯å¢ƒ
```bash
- Android Studio 4.0+
- Android SDK API Level 21+
- Gradle 7.0+
- Java 8+
```

#### Control App ç¯å¢ƒ
```bash
- Flutter SDK 3.0+
- Dart 2.18+
- Android Studio æˆ– VS Code
- Android SDK / Xcode (iOSå¼€å‘)
```

### ğŸ› ï¸ ç¼–è¯‘å®‰è£…

#### 1. Device App ç¼–è¯‘
```bash
cd remote_control_apps/DeviceApp
./gradlew assembleDebug
# å®‰è£…åˆ°Androidè®¾å¤‡
adb install app/build/outputs/apk/debug/app-debug.apk
```

#### 2. Control App ç¼–è¯‘
```bash
cd remote_control_apps/control_app
flutter pub get
flutter build apk
# å®‰è£…åˆ°æ§åˆ¶è®¾å¤‡
flutter install
```

## ğŸš€ ä½¿ç”¨æŒ‡å—

### ğŸ“± Device App ä½¿ç”¨æ­¥éª¤

#### 1. å¯åŠ¨åº”ç”¨
- åœ¨è¢«æ§åˆ¶çš„Androidè®¾å¤‡ä¸Šå¯åŠ¨Device App
- åº”ç”¨å°†æ˜¾ç¤ºå½“å‰è®¾å¤‡çš„IPåœ°å€å’Œç«¯å£ä¿¡æ¯

#### 2. æˆæƒæƒé™
```
ç¬¬ä¸€æ¬¡ä½¿ç”¨éœ€è¦æˆæƒä»¥ä¸‹æƒé™ï¼š(å½“ç„¶ï¼Œæˆ‘ä»¬è‡ªå·±çš„ç³»ç»Ÿä¸éœ€è¦ï¼Œå› ä¸ºç³»ç»Ÿæƒé™)
âœ… å±å¹•å½•åˆ¶æƒé™ (MediaProjection)
âœ… ç½‘ç»œè®¿é—®æƒé™
âœ… å‰å°æœåŠ¡æƒé™
```

#### 3. å¼€å§‹æœåŠ¡
- ç‚¹å‡»"å¼€å§‹å±å¹•å…±äº«"æŒ‰é’®
- ç³»ç»Ÿå°†å¼¹å‡ºå±å¹•å½•åˆ¶æˆæƒå¯¹è¯æ¡†ï¼ˆno needï¼‰
- ç‚¹å‡»"ç«‹å³å¼€å§‹"æˆæƒå±å¹•å½•åˆ¶
- åº”ç”¨å°†å¯åŠ¨WebSocketæœåŠ¡å™¨ (ç«¯å£: 4321)
- çŠ¶æ€æ å°†æ˜¾ç¤º"å±å¹•å…±äº«å·²å¯åŠ¨"

#### 4. ç½‘ç»œé…ç½®
- ç¡®ä¿è®¾å¤‡è¿æ¥åˆ°å±€åŸŸç½‘WiFi
- è®°å½•æ˜¾ç¤ºçš„IPåœ°å€ (ä¾‹å¦‚: 192.168.10.182)
- ç¡®ä¿é˜²ç«å¢™æœªé˜»æ­¢4321ç«¯å£

### ğŸ“± Control App ä½¿ç”¨æ­¥éª¤

#### 1. å¯åŠ¨åº”ç”¨
- ç¡®è®¤è‡ªå·±è®¾å¤‡ç«¯çš„ipå¤šå°‘ï¼Œæ‰‹åŠ¨åœ¨ä»£ç ä¸­ä¿®æ”¹å¯¹åº”çš„ip
- åœ¨æ§åˆ¶è®¾å¤‡ä¸Šå¯åŠ¨Control App
- åº”ç”¨å°†æ˜¾ç¤ºè®¾å¤‡å‘ç°ç•Œé¢

#### 2. è¿æ¥è®¾å¤‡
- åº”ç”¨ä¼šè‡ªåŠ¨æ‰«æå±€åŸŸç½‘å†…çš„è®¾å¤‡
- æˆ–è€…æ‰‹åŠ¨è¾“å…¥Device Appæ˜¾ç¤ºçš„IPåœ°å€
- ç‚¹å‡»è®¾å¤‡åˆ—è¡¨ä¸­çš„ç›®æ ‡è®¾å¤‡

#### 3. å»ºç«‹è¿æ¥
```
è¿æ¥è¿‡ç¨‹ï¼š
ğŸ”„ WebSocketè¿æ¥å»ºç«‹
ğŸ”„ WebRTCä¿¡ä»¤äº¤æ¢
ğŸ”„ è§†é¢‘æµä¼ è¾“å»ºç«‹
ğŸ”„ æ§åˆ¶é€šé“å»ºç«‹
âœ… è¿æ¥æˆåŠŸï¼Œå¼€å§‹è¿œç¨‹æ§åˆ¶
```

#### 4. è¿œç¨‹æ§åˆ¶
- **ğŸ‘† å•å‡»**ï¼šè½»è§¦å±å¹•ä»»æ„ä½ç½®
- **ğŸ‘† é•¿æŒ‰**ï¼šé•¿æŒ‰å±å¹•è§¦å‘é•¿æŒ‰äº‹ä»¶
- **ğŸ‘† æ»‘åŠ¨**ï¼šæŒ‰ä½å¹¶æ»‘åŠ¨è¿›è¡Œæ‹–æ‹½æ“ä½œ
- **âŒ¨ï¸ ç³»ç»ŸæŒ‰é”®**ï¼šä½¿ç”¨å³ä¾§æ§åˆ¶é¢æ¿çš„æŒ‰é’®

### ğŸ® æ§åˆ¶æ“ä½œè¯´æ˜

#### è§¦æ‘¸æ‰‹åŠ¿
| æ‰‹åŠ¿ | æ“ä½œ | è¯´æ˜ |
|------|------|------|
| ğŸ‘† è½»è§¦ | å•å‡» | åœ¨ç›®æ ‡ä½ç½®æ‰§è¡Œç‚¹å‡»æ“ä½œ |
| ğŸ‘† é•¿æŒ‰ | é•¿æŒ‰ | è§¦å‘é•¿æŒ‰èœå•æˆ–ç‰¹æ®ŠåŠŸèƒ½ |
| ğŸ‘† æ»‘åŠ¨ | æ‹–æ‹½/æ»‘åŠ¨ | æ”¯æŒå„ç§æ–¹å‘çš„æ»‘åŠ¨æ“ä½œ |

#### ç³»ç»ŸæŒ‰é”®
| æŒ‰é”® | åŠŸèƒ½ | å¯¹åº”AndroidæŒ‰é”® |
|------|------|----------------|
| ğŸ”™ è¿”å› | Backé”® | KEYCODE_BACK |
| ğŸ  ä¸»é¡µ | Homeé”® | KEYCODE_HOME |
| â˜° èœå• | Menué”® | KEYCODE_MENU |

#### åæ ‡æ˜ å°„
```
æ§åˆ¶ç«¯å±å¹•åæ ‡ â†’ è®¾å¤‡ç«¯å±å¹•åæ ‡
æ˜ å°„ç®—æ³•ï¼š
deviceX = (touchX / controlWidth) Ã— 1824
deviceY = (touchY / controlHeight) Ã— 1080
```

## ğŸ“Š è¿æ¥æµç¨‹è¯¦è§£

### ğŸ”— WebSocketä¿¡ä»¤æµç¨‹
```mermaid
sequenceDiagram
    participant C as Control App
    participant D as Device App
    
    Note over C,D: WebSocketä¿¡ä»¤å»ºç«‹
    C->>D: WebSocketè¿æ¥è¯·æ±‚ (ws://192.168.10.182:4321)
    D->>C: è¿æ¥ç¡®è®¤ + è®¾å¤‡ä¿¡æ¯
    C->>D: pingæ¶ˆæ¯
    D->>C: pongå“åº” (è®¾å¤‡çŠ¶æ€)
    
    Note over C,D: WebRTCè¿æ¥å»ºç«‹
    C->>D: start_webrtcè¯·æ±‚
    D->>C: SDP Offer (è§†é¢‘å‘é€é…ç½®)
    C->>D: SDP Answer (æ¥æ”¶ç¡®è®¤)
    
    Note over C,D: ICEå€™é€‰äº¤æ¢
    D->>C: ICE Candidate (è®¾å¤‡ç«¯)
    C->>D: ICE Candidate (æ§åˆ¶ç«¯)
    
    Note over C,D: è¿æ¥å»ºç«‹æˆåŠŸ
    D->>C: è§†é¢‘æµä¼ è¾“å¼€å§‹
    C->>D: æ§åˆ¶äº‹ä»¶é€šé“å»ºç«‹
```

### ğŸ¯ æ§åˆ¶äº‹ä»¶æµç¨‹
```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant C as Control App
    participant D as Device App
    participant S as Androidç³»ç»Ÿ
    
    U->>C: è§¦æ‘¸å±å¹•
    C->>C: åæ ‡æ˜ å°„è½¬æ¢
    C->>D: ControlEvent (via DataChannel)
    D->>D: è§£ææ§åˆ¶äº‹ä»¶
    D->>S: Shellå‘½ä»¤æ‰§è¡Œ
    S->>S: æ¨¡æ‹Ÿè§¦æ‘¸æ“ä½œ
    Note over D,S: input tap x y
    S->>D: æ‰§è¡Œç»“æœ
    D->>C: å±å¹•ç”»é¢æ›´æ–°
    C->>U: æ˜¾ç¤ºæ“ä½œç»“æœ
```

### ğŸ”„ é‡è¿æœºåˆ¶æµç¨‹
```mermaid
flowchart TD
    A[åº”ç”¨å¯åŠ¨/æ¢å¤] --> B{æ£€æŸ¥è¿æ¥çŠ¶æ€}
    B -->|å·²è¿æ¥| C[æ­£å¸¸ä½¿ç”¨]
    B -->|æœªè¿æ¥| D[å¼€å§‹é‡è¿]
    
    D --> E[æ¸…ç†æ—§è¿æ¥]
    E --> F[é‡æ–°åˆ›å»ºè§†é¢‘æ¸²æŸ“å™¨]
    F --> G[é‡æ–°åˆå§‹åŒ–æœåŠ¡]
    G --> H[WebSocketé‡è¿]
    H --> I{è¿æ¥æˆåŠŸ?}
    
    I -->|æˆåŠŸ| J[WebRTCé‡æ–°å»ºç«‹]
    I -->|å¤±è´¥| K[ç­‰å¾…3ç§’]
    K --> D
    
    J --> L{è§†é¢‘æµå»ºç«‹?}
    L -->|æˆåŠŸ| M[æ§åˆ¶é€šé“å»ºç«‹]
    L -->|å¤±è´¥| N[WebRTCé‡è¯•]
    N --> J
    
    M --> O{æ§åˆ¶é€šé“OK?}
    O -->|æˆåŠŸ| C
    O -->|å¤±è´¥| P[å®Œæ•´é‡è¿]
    P --> D
    
    C --> Q[ç›‘æ§è¿æ¥çŠ¶æ€]
    Q --> R{è¿æ¥ä¸­æ–­?}
    R -->|æ˜¯| D
    R -->|å¦| C
```

## âš™ï¸ é…ç½®è¯´æ˜

### Device App é…ç½®

#### æ€§èƒ½å‚æ•°é…ç½® (WebRTCManager.java)
```java
// è§†é¢‘è´¨é‡é…ç½®
private final static int FRAME_RATE = 30;          // å¸§ç‡
private final static int MAX_BITRATE = 500000;     // ç ç‡ (bps)

// RTPç¼–ç å‚æ•°
encoding.maxBitrateBps = MAX_BITRATE;               // æœ€å¤§ç ç‡
encoding.maxFramerate = FRAME_RATE;                // æœ€å¤§å¸§ç‡
encoding.scaleResolutionDownBy = 2.0;              // åˆ†è¾¨ç‡ç¼©æ”¾
```

#### ç½‘ç»œé…ç½® (WebSocketService.java)
```java
private static final int PORT = 4321;              // WebSocketç«¯å£
// ç»‘å®šåœ°å€ï¼š"0.0.0.0" (æ‰€æœ‰ç½‘ç»œæ¥å£)
```

#### å±å¹•æ•è·é…ç½® (ScreenCaptureService.java)
```java
private static final int FRAME_RATE = 30;          // æ•è·å¸§ç‡
// åˆ†è¾¨ç‡ï¼šè‡ªåŠ¨æ£€æµ‹è®¾å¤‡å±å¹•åˆ†è¾¨ç‡
```

### Control App é…ç½®

#### WebRTCå®¢æˆ·ç«¯é…ç½® (webrtc_service.dart)
```dart
// ICEæœåŠ¡å™¨é…ç½®
final configuration = {
  'iceServers': [
    {'urls': 'stun:stun.l.google.com:19302'},      // STUNæœåŠ¡å™¨ éœ€è¦åˆ é™¤ï¼ˆè®¾å¤‡ç«¯å·²ç»åˆ é™¤ï¼‰
  ],
};

// æ•°æ®é€šé“é…ç½®
RTCDataChannelInit()..ordered = true;              // æœ‰åºä¼ è¾“
```

#### è®¾å¤‡å‘ç°é…ç½® (device_discovery_service.dart)
```dart
final String defaultDeviceIP = '192.168.10.182';   // é»˜è®¤è®¾å¤‡IP
final int defaultPort = 4321;                      // é»˜è®¤ç«¯å£
```

#### è§¦æ‘¸æ˜ å°„é…ç½® (control_screen.dart)
```dart
final double deviceWidth = 1824;                   // ç›®æ ‡è®¾å¤‡å®½åº¦
final double deviceHeight = 1080;                  // ç›®æ ‡è®¾å¤‡é«˜åº¦
final double minSwipeDistance = 20;                // æœ€å°æ»‘åŠ¨è·ç¦»
```

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ

#### ğŸ”´ è¿æ¥å¤±è´¥
**é—®é¢˜**ï¼šControl Appæ— æ³•è¿æ¥åˆ°Device App
**æ’æŸ¥æ­¥éª¤**ï¼š
1. âœ… ç¡®è®¤ä¸¤è®¾å¤‡åœ¨åŒä¸€WiFiç½‘ç»œ
2. âœ… æ£€æŸ¥Device Appçš„IPåœ°å€æ˜¾ç¤º
3. âœ… ç¡®è®¤Device Appçš„WebSocketæœåŠ¡å·²å¯åŠ¨
4. âœ… æ£€æŸ¥ç½‘ç»œé˜²ç«å¢™è®¾ç½®
5. âœ… å°è¯•æ‰‹åŠ¨è¾“å…¥IPåœ°å€è¿æ¥

**è§£å†³æ–¹æ³•**ï¼š
```bash
# 1. æ£€æŸ¥ç½‘ç»œè¿é€šæ€§
ping 192.168.10.182

# 2. æ£€æŸ¥ç«¯å£å¼€æ”¾
telnet 192.168.10.182 4321

# 3. é‡å¯Device AppæœåŠ¡
# åœ¨Device Appä¸­é‡æ–°ç‚¹å‡»"å¼€å§‹å±å¹•å…±äº«"
```

#### ğŸ”´ é»‘å±é—®é¢˜
**é—®é¢˜**ï¼šè¿æ¥æˆåŠŸä½†æ˜¾ç¤ºé»‘å±
**å¯èƒ½åŸå› **ï¼š
1. å±å¹•å½•åˆ¶æƒé™æœªæˆæƒ
2. MediaProjectionæœåŠ¡æœªæ­£å¸¸å¯åŠ¨
3. WebRTCè§†é¢‘æµä¼ è¾“ä¸­æ–­

**è§£å†³æ–¹æ³•**ï¼š
```bash
# 1. é‡æ–°æˆæƒå±å¹•å½•åˆ¶æƒé™
# åœ¨Device Appä¸­é‡æ–°å¯åŠ¨å±å¹•å…±äº«

# 2. æ£€æŸ¥åº”ç”¨æ—¥å¿—
adb logcat | grep "ScreenCaptureService\|WebRTCManager"

# 3. é‡å¯åº”ç”¨
# å®Œå…¨å…³é—­Device Appå¹¶é‡æ–°å¯åŠ¨
```

#### ğŸ”´ è§¦æ‘¸ä¸å“åº”
**é—®é¢˜**ï¼šèƒ½çœ‹åˆ°ç”»é¢ä½†æ— æ³•æ§åˆ¶
**æ’æŸ¥æ­¥éª¤**ï¼š
1. âœ… ç¡®è®¤DataChannelè¿æ¥çŠ¶æ€
2. âœ… æ£€æŸ¥è§¦æ‘¸æƒé™è®¾ç½®
3. âœ… éªŒè¯åæ ‡æ˜ å°„æ˜¯å¦æ­£ç¡®

**è§£å†³æ–¹æ³•**ï¼š
```bash
# 1. æ£€æŸ¥è§¦æ‘¸äº‹ä»¶æ—¥å¿—
adb logcat | grep "TouchControlService\|ControlEvent"

# 2. æ‰‹åŠ¨æµ‹è¯•è§¦æ‘¸å‘½ä»¤
adb shell input tap 500 500

# 3. æ£€æŸ¥æ§åˆ¶ç«¯æ—¥å¿—
# æŸ¥çœ‹Control Appçš„è°ƒè¯•è¾“å‡º
```

#### ğŸ”´ å»¶è¿Ÿè¿‡é«˜
**é—®é¢˜**ï¼šæ“ä½œå“åº”å»¶è¿Ÿæ˜æ˜¾
**ä¼˜åŒ–æ–¹æ³•**ï¼š
1. è°ƒæ•´è§†é¢‘è´¨é‡å‚æ•°
2. æ£€æŸ¥ç½‘ç»œè´¨é‡
3. ä¼˜åŒ–è®¾å¤‡æ€§èƒ½

```java
// é™ä½ç ç‡å‡å°‘å»¶è¿Ÿ
private final static int MAX_BITRATE = 300000;     // æ”¹ä¸º300kbps

// é™ä½å¸§ç‡
private final static int FRAME_RATE = 24;          // æ”¹ä¸º24fps

// è°ƒæ•´åˆ†è¾¨ç‡ç¼©æ”¾
encoding.scaleResolutionDownBy = 3.0;              // æé«˜ç¼©æ”¾æ¯”ä¾‹
```

#### ğŸ”´ åº”ç”¨å´©æºƒ
**é—®é¢˜**ï¼šåº”ç”¨æ„å¤–é€€å‡º
**è°ƒè¯•æ–¹æ³•**ï¼š
```bash
# 1. æŸ¥çœ‹å´©æºƒæ—¥å¿—
adb logcat | grep "AndroidRuntime\|FATAL"

# 2. æ£€æŸ¥å†…å­˜ä½¿ç”¨
adb shell dumpsys meminfo com.example.deviceapp

# 3. æ£€æŸ¥æƒé™çŠ¶æ€
adb shell dumpsys package com.example.deviceapp | grep permission
```

### ğŸ“Š æ€§èƒ½ç›‘æ§

#### ç›‘æ§æŒ‡æ ‡
```bash
# 1. CPUä½¿ç”¨ç‡
adb shell top | grep deviceapp

# 2. å†…å­˜ä½¿ç”¨
adb shell dumpsys meminfo com.example.deviceapp

# 3. ç½‘ç»œæµé‡
adb shell cat /proc/net/dev

# 4. å¸§ç‡ç»Ÿè®¡
# åœ¨WebRTCæ—¥å¿—ä¸­æŸ¥çœ‹ "EglRenderer: Duration"
```

#### æ€§èƒ½ä¼˜åŒ–å»ºè®®
1. **ğŸ“± è®¾å¤‡æ€§èƒ½**ï¼šå»ºè®®ä½¿ç”¨ä¸­é«˜ç«¯Androidè®¾å¤‡
2. **ğŸŒ ç½‘ç»œç¯å¢ƒ**ï¼šä½¿ç”¨5GHz WiFiï¼Œç¡®ä¿è‰¯å¥½ä¿¡å·å¼ºåº¦
3. **âš¡ ç”µæºç®¡ç†**ï¼šå…³é—­çœç”µæ¨¡å¼ï¼Œä¿æŒè®¾å¤‡å……ç”µ
4. **ğŸš« åå°é™åˆ¶**ï¼šæ·»åŠ åº”ç”¨åˆ°ç™½åå•ï¼Œé˜²æ­¢åå°æ€æ­»

## ğŸ“ å¼€å‘è¯´æ˜

### é¡¹ç›®ç»“æ„
```
WebRTC_demo/
â”œâ”€â”€ remote_control_apps/
â”‚   â”œâ”€â”€ DeviceApp/                 # Androidè¢«æ§è®¾å¤‡ç«¯
â”‚   â”‚   â”œâ”€â”€ app/src/main/java/com/example/deviceapp/
â”‚   â”‚   â”‚   â”œâ”€â”€ MainActivity.java           # ä¸»ç•Œé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ ScreenCaptureService.java   # å±å¹•æ•è·æœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ WebSocketService.java       # WebSocketæœåŠ¡å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ WebRTCManager.java          # WebRTCç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ TouchControlService.java    # è§¦æ‘¸æ§åˆ¶
â”‚   â”‚   â”‚   â””â”€â”€ ControlEvent.java           # æ§åˆ¶äº‹ä»¶æ¨¡å‹
â”‚   â”‚   â””â”€â”€ app/src/main/res/               # Androidèµ„æºæ–‡ä»¶
â”‚   â”‚
â”‚   â””â”€â”€ control_app/              # Flutteræ§åˆ¶ç«¯
â”‚       â”œâ”€â”€ lib/
â”‚       â”‚   â”œâ”€â”€ main.dart                   # åº”ç”¨å…¥å£
â”‚       â”‚   â”œâ”€â”€ screens/
â”‚       â”‚   â”‚   â”œâ”€â”€ device_list_screen.dart # è®¾å¤‡åˆ—è¡¨ç•Œé¢
â”‚       â”‚   â”‚   â””â”€â”€ control_screen.dart     # æ§åˆ¶ç•Œé¢
â”‚       â”‚   â”œâ”€â”€ services/
â”‚       â”‚   â”‚   â”œâ”€â”€ device_discovery_service.dart  # è®¾å¤‡å‘ç°
â”‚       â”‚   â”‚   â”œâ”€â”€ websocket_service.dart          # WebSocketå®¢æˆ·ç«¯
â”‚       â”‚   â”‚   â””â”€â”€ webrtc_service.dart             # WebRTCå®¢æˆ·ç«¯
â”‚       â”‚   â””â”€â”€ models/
â”‚       â”‚       â”œâ”€â”€ device.dart             # è®¾å¤‡æ¨¡å‹
â”‚       â”‚       â””â”€â”€ control_event.dart      # æ§åˆ¶äº‹ä»¶æ¨¡å‹
â”‚       â””â”€â”€ pubspec.yaml                    # Flutterä¾èµ–é…ç½®
â”‚
â””â”€â”€ README.md                     # é¡¹ç›®æ–‡æ¡£ (æœ¬æ–‡ä»¶)
```

### è´¡çŒ®æŒ‡å—

#### å¼€å‘ç¯å¢ƒæ­å»º
1. **å…‹éš†ä»£ç åº“**
2. **é…ç½®Androidå¼€å‘ç¯å¢ƒ**
3. **é…ç½®Flutterå¼€å‘ç¯å¢ƒ**
4. **è¿è¡Œæµ‹è¯•ç¡®ä¿ç¯å¢ƒæ­£å¸¸**

#### ä»£ç è§„èŒƒ
- **Java**: éµå¾ªGoogle Java Style Guide
- **Dart**: éµå¾ªDartå®˜æ–¹ä»£ç è§„èŒƒ
- **æäº¤**: ä½¿ç”¨Conventional Commitsè§„èŒƒ

#### åŠŸèƒ½æ‰©å±•å»ºè®®
1. **ğŸ” è®¾å¤‡å‘ç°**: å®ç°mDNS/Bonjourè‡ªåŠ¨å‘ç°
2. **ğŸ”’ å®‰å…¨è®¤è¯**: æ·»åŠ è®¾å¤‡é…å¯¹å’ŒåŠ å¯†ä¼ è¾“
3. **ğŸµ éŸ³é¢‘æ”¯æŒ**: æ”¯æŒéŸ³é¢‘æµä¼ è¾“
4. **ğŸ“ æ–‡ä»¶ä¼ è¾“**: å®ç°æ–‡ä»¶æ‹–æ‹½ä¼ è¾“
5. **ğŸ® å¤šç‚¹è§¦æ§**: æ”¯æŒæ›´å¤æ‚çš„æ‰‹åŠ¿æ“ä½œ
6. **ğŸ“Š æ€§èƒ½ç›‘æ§**: æ·»åŠ å®æ—¶æ€§èƒ½æŒ‡æ ‡æ˜¾ç¤º

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®éµå¾ª MIT è®¸å¯è¯ï¼Œè¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

## ğŸ‘¥ ä½œè€…ä¿¡æ¯

- **å¼€å‘è€…**: Me & Claude Code Assistant
- **é¡¹ç›®ç±»å‹**: WebRTCè¿œç¨‹æ§åˆ¶æ¼”ç¤ºé¡¹ç›®
- **æŠ€æœ¯æ”¯æŒ**: åŸºäºWebRTCã€WebSocketã€FlutteræŠ€æœ¯æ ˆ

## ğŸ™ è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®çš„æ”¯æŒï¼š
- [WebRTC](https://webrtc.org/) - å®æ—¶é€šä¿¡æŠ€æœ¯
- [Flutter](https://flutter.dev/) - è·¨å¹³å°UIæ¡†æ¶
- [Java-WebSocket](https://github.com/TooTallNate/Java-WebSocket) - WebSocketæœåŠ¡å™¨å®ç°
- [flutter_webrtc](https://pub.dev/packages/flutter_webrtc) - Flutter WebRTCæ’ä»¶

---

ğŸ“ **æŠ€æœ¯æ”¯æŒ**: å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹æ•…éšœæ’é™¤ç« èŠ‚æˆ–æäº¤Issue  
ğŸ”„ **ç‰ˆæœ¬**: v1.0.0  
ğŸ“… **æ›´æ–°æ—¶é—´**: 2025-06-19